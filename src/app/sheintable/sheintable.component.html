<app-navigation></app-navigation>
<section>
<div class="card-container">

  <!-- FORM CARD -->
  <mat-card class="form-card mat-elevation-z4">
    <mat-card-title>Client Order Form</mat-card-title>
    <mat-card-content>
      <form [formGroup]="userForm" (ngSubmit)="onClick()">

        <div class="form-grid">
          <mat-form-field appearance="fill">
            <mat-icon matPrefix>person</mat-icon>
            <mat-label>Client</mat-label>
            <input matInput formControlName="client" required />
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-icon matPrefix>attach_money</mat-icon>
            <mat-label>Cost</mat-label>
            <input matInput type="number" formControlName="cost" required />
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-icon matPrefix>local_shipping</mat-icon>
            <mat-label>Delivery</mat-label>
            <input matInput type="number" formControlName="delivery" required />
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-icon matPrefix>percent</mat-icon>
            <mat-label>Discount (%)</mat-label>
            <input matInput type="number" formControlName="discount" required />
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-icon matPrefix>local_shipping</mat-icon>
            <mat-label>Shipping Cost</mat-label>
            <input matInput type="number" formControlName="shippingCost" required />
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-icon matPrefix>grid_on</mat-icon>
            <mat-label>Quantity</mat-label>
            <input matInput type="number" formControlName="quantity" required />
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-icon matPrefix>check_circle</mat-icon>
            <mat-label>Choice</mat-label>
            <mat-select formControlName="choice" required>
              <mat-option value="Pending">Pending</mat-option>
              <mat-option value="Done">Done</mat-option>
            </mat-select>
          </mat-form-field>

          <div class="slide-toggle-wrapper">
            <mat-slide-toggle formControlName="includeQuantityInProfit" (change)="onQuantityProfitChange()">
              Include Quantity in Profit
            </mat-slide-toggle>
          </div>
        </div>

        <div class="form-actions">
          <button mat-raised-button color="primary" type="submit">
            {{ switch ? 'Update' : 'Add' }}
          </button>

          <button *ngIf="showCancelButton" mat-stroked-button type="button" (click)="onCancel()">Cancel</button>
          <button mat-stroked-button type="button" (click)="onClear()">Clear</button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>

  <!-- TABLE CARD -->
  <mat-card class="table-card mat-elevation-z4">
    <mat-card-title>Order Summary</mat-card-title>
    <mat-card-content>

      <table mat-table [dataSource]="onselect" class="mat-elevation-z2 full-width-table">

        <!-- Client -->
        <ng-container matColumnDef="client">
          <th mat-header-cell *matHeaderCellDef> <mat-icon>person</mat-icon> Client </th>
          <td mat-cell *matCellDef="let element"> {{ element.client }} </td>
        </ng-container>

        <!-- Quantity -->
        <ng-container matColumnDef="quantity">
          <th mat-header-cell *matHeaderCellDef> <mat-icon>grid_on</mat-icon> Quantity </th>
          <td mat-cell *matCellDef="let element"> {{ element.quantity }} </td>
        </ng-container>

        <!-- Cost -->
        <ng-container matColumnDef="cost">
          <th mat-header-cell *matHeaderCellDef> <mat-icon>attach_money</mat-icon> Cost </th>
          <td mat-cell *matCellDef="let element"> {{ element.cost }} </td>
        </ng-container>

        <!-- Discount -->
        <ng-container matColumnDef="discount">
          <th mat-header-cell *matHeaderCellDef> <mat-icon>percent</mat-icon> Discount (%) </th>
          <td mat-cell *matCellDef="let element"> {{ element.discount }} </td>
        </ng-container>

        <!-- Delivery -->
        <ng-container matColumnDef="delivery">
          <th mat-header-cell *matHeaderCellDef> <mat-icon>local_shipping</mat-icon> Delivery </th>
          <td mat-cell *matCellDef="let element"> {{ element.delivery }} </td>
        </ng-container>

        <!-- Shipping Cost -->
        <ng-container matColumnDef="shippingCost">
          <th mat-header-cell *matHeaderCellDef> <mat-icon>local_shipping</mat-icon> Shipping </th>
          <td mat-cell *matCellDef="let element"> {{ element.shippingCost }} </td>
        </ng-container>

        <!-- Choice -->
        <ng-container matColumnDef="choice">
          <th mat-header-cell *matHeaderCellDef> <mat-icon>check_circle</mat-icon> Choice </th>
          <td mat-cell *matCellDef="let element"> {{ element.choice }} </td>
        </ng-container>

        <!-- Profit -->
        <ng-container matColumnDef="profit">
          <th mat-header-cell *matHeaderCellDef> Profit </th>
          <td mat-cell *matCellDef="let element"> {{ calculateProfit(element) }} </td>
        </ng-container>

        <!-- Actions -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef> Actions </th>
          <td mat-cell *matCellDef="let element; let i = index">
            <button mat-icon-button color="accent" (click)="onEdit(i)">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button color="warn" (click)="onClean(i)">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="['client', 'quantity', 'cost', 'discount', 'delivery', 'shippingCost', 'choice', 'profit', 'actions']"></tr>
        <tr mat-row *matRowDef="let row; columns: ['client', 'quantity', 'cost', 'discount', 'delivery', 'shippingCost', 'choice', 'profit', 'actions'];"></tr>
      </table>

      <div class="summary-footer">
        <p><strong>Total Cost:</strong> {{ calculateOverallTotal() }}</p>
        <p><strong>Total Profit:</strong> {{ calculateOverallProfit() }}</p>
        <button mat-raised-button color="primary" (click)="onSave()">Save All</button>
      </div>

    </mat-card-content>
  </mat-card>

</div>
</section>